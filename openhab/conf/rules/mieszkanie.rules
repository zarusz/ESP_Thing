rule "Zmiana stanu"
when
	Item Mode received update
then
	logInfo("Ceiling", "Turning all lights off")
	if (Mode.state == "Normal") {
		sendCommand(SleepLevel, 0)
	}

	if (Mode.state == "Sleeping" || Mode.state == "Away") {
		sendCommand(SleepLevel, 4)
		if (Lights.state == ON) sendCommand(Lights, OFF)
		if (Yamaha_Power.state == ON) sendCommand(Yamaha_Power, OFF)
	}
end

rule "Tryb - ustaw normalny po spaniu jeżeli 6 rano"
when
	Time cron "0 00 07 ? * *"
then
	if (Mode.state == "Sleeping") {
		logInfo("Tryb", "Tryb: normalny")
		sendCommand(Mode, "Normal")
	}
end

rule "Tryb - ustaw sleeping jeżeli 1 rano i brak ruchu od 30 minut"
when
	Time cron "0 */5 0-8 ? * *"
then
	if (CMotionLastMinutes.state >= 30 && Mode.state == "Normal") {
		logInfo("Tryb", "Tryb: spanie")
		sendCommand(Mode, "Sleeping")
	}	
end
